pq-sys
======

Autogenerated Rust bindings for libpq

Building
--------

Run the following command to update the bindings:

```
bindgen --rustified-enum '.*' wrapper.h --raw-line '#![allow(non_camel_case_types, non_upper_case_globals, non_snake_case)]' --raw-line '#[link(name="pq")] extern "C" {}' > src/lib.rs
```

## FAQ

### I'm seeing `dyld: Symbol not found __cg_jpeg_resync_to_restart` on macOS

This is caused when the output of `pg_config --libdir` is a directory that also
contains `libjpeg.dylib` which differs from the system libjpeg. This is usually
caused by install postgres via homebrew, or using postgresapp.com.

If you've installed via homebrew, you should not see this issue unless you've
provided `features = ["pkg-config"]`. You can work around the issue by exporting
`PQ_LIB_DIR="$(brew --prefix postgres)/lib"`.

If you've installed postgresql using postgresapp.com, you will not be able to
run your binaries using `cargo run` or `cargo test`. You can compile the binary
manually via `cargo build` and then run `/target/debug/yourapp`. You can also
manually create a directory that contains only a symlink to `libpq.dylib` and
nothing else, then export `PQ_LIB_DIR` to that directory. It is recommended that
you do not use postgresapp.com.

## License

Licensed under either of

 * Apache License, Version 2.0, ([LICENSE-APACHE](LICENSE-APACHE) or
   http://www.apache.org/licenses/LICENSE-2.0)
 * MIT license ([LICENSE-MIT](LICENSE-MIT) or
   http://opensource.org/licenses/MIT)

at your option.

### Contribution

Unless you explicitly state otherwise, any contribution intentionally submitted
for inclusion in the work by you, as defined in the Apache-2.0 license, shall be
dual licensed as above, without any additional terms or conditions.
